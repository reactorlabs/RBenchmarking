library(boot)

function_to_run <- function() {
    Gamma <- stats::Gamma
    glm <- stats::glm
    leuk <- structure(list(wbc = c(2300L, 750L, 4300L, 2600L, 6000L, 10500L, 10000L, 17000L, 5400L, 7000L, 9400L, 32000L, 
        35000L, 100000L, 100000L, 52000L, 100000L, 4400L, 3000L, 4000L, 1500L, 9000L, 5300L, 10000L, 19000L, 27000L, 28000L, 
        31000L, 26000L, 21000L, 79000L, 100000L, 100000L), ag = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
        2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("absent", "present"), 
        class = "factor"), time = c(65L, 156L, 100L, 134L, 16L, 108L, 121L, 4L, 39L, 143L, 56L, 26L, 22L, 1L, 1L, 5L, 65L, 
        56L, 65L, 17L, 7L, 16L, 22L, 3L, 4L, 2L, 3L, 8L, 4L, 3L, 30L, 4L, 43L)), class = "data.frame", row.names = c(NA, 
        33L))
    leuk.mod <- structure(list(coefficients = structure(c(5.81541090296917, 6.83305612256147, -0.700907826153979), names = c("agabsent", 
        "agpresent", "log10(wbc)")), residuals = structure(c(-0.260963156212554, 0.2610602367463, 0.37553196512551, 0.581486492981557, 
        -0.756425303217467, 0.949471196909766, 1.1519313207727, -0.916391242057684, -0.425026013388384, 1.2815335266343, 
        -0.0226476283056856, -0.341153504247312, -0.42709811903687, -0.964153774084133, -0.964153774084133, -0.853119295898988, 
        1.33000468453135, 1.14612798852744, 1.21691783110398, -0.367127007490862, -0.806669386799719, -0.237583785646044, 
        -0.107736999144116, -0.852387887870583, -0.760716121741415, -0.866850960387892, -0.798053152216393, -0.444528957510346, 
        -0.73674369298812, -0.814985538052199, 1.76923646157776, -0.603300975729073, 3.26451451091246), names = c("1", "2", 
        "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", 
        "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33")), fitted.values = structure(c(87.9523132661227, 
        123.705430917797, 72.6991466104355, 84.7304106577423, 65.6882681631131, 55.3996387180266, 56.2285602853498, 47.841878033396, 
        67.829155593336, 62.6771416376915, 57.2976560162429, 39.4629100520551, 38.400991044077, 27.896939620563, 27.896939620563, 
        34.0412311515161, 27.896939620563, 26.0935043479975, 29.3199861032428, 26.8616297443828, 36.2074059773884, 20.9859125485124, 
        24.6564073360623, 20.323535492601, 16.7165461756573, 15.020761740576, 14.855394045143, 14.4021909119574, 15.1943178319352, 
        16.2149486500488, 10.8333110647068, 10.0832110876789, 10.0832110876789), names = c("1", "2", "3", "4", "5", "6", 
        "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", 
        "27", "28", "29", "30", "31", "32", "33")), effects = structure(c(-11.5458465713962, -16.3365056603138, -2.3084520212068, 
        0.489677980109952, -0.814692073642949, 0.913563204121454, 1.11406060281141, -0.932900831110485, -0.487526192277839, 
        1.22937456570427, -0.0629477264081434, -0.332343696575102, -0.414690903507385, -0.909620943383555, -0.909620943383555, 
        -0.824811725088024, 1.38432894015629, 1.18623907426396, 1.24169720315023, -0.330950736782622, -0.809846740116303, 
        -0.168898625056334, -0.0602634094020694, -0.77951640195851, -0.66210930891386, -0.754161708913855, -0.683903399691325, 
        -0.32628660525365, -0.625562388099194, -0.71236902935325, 1.92500633274204, -0.438118927222005, 3.42973681710519), 
        names = c("agabsent", "agpresent", "log10(wbc)", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", 
            "", "", "", "", "", "", "", "", "", "", "", "", "", "")), R = structure(c(-4, 0, 0, 0, -4.12310562561766, 0, 
        -16.7151750962283, -16.8879644898989, 3.29351725728865), .Dim = c(3L, 3L), .Dimnames = list(c("agabsent", "agpresent", 
        "log10(wbc)"), c("agabsent", "agpresent", "log10(wbc)"))), rank = 3L, qr = structure(list(qr = structure(c(-4, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 
        0.25, 0.25, 0.25, 0.25, 0, -4.12310562561766, 0.242535625036333, 0.242535625036333, 0.242535625036333, 0.242535625036333, 
        0.242535625036333, 0.242535625036333, 0.242535625036333, 0.242535625036333, 0.242535625036333, 0.242535625036333, 
        0.242535625036333, 0.242535625036333, 0.242535625036333, 0.242535625036333, 0.242535625036333, -0.0606339062590832, 
        -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, 
        -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, 
        -0.0606339062590832, -0.0606339062590832, -0.0606339062590832, -16.7151750962283, -16.8879644898989, 3.29351725728865, 
        0.134401211313715, 0.0241306786152438, -0.0496621785949148, -0.0432285402033, -0.113199001377682, 0.0380238775834327, 
        0.00380384125544009, -0.035069437244045, -0.196605595447809, -0.208422162051261, -0.346855308147804, -0.346855308147804, 
        -0.260626321268592, -0.346855308147804, 0.124901893699404, 0.175404565697988, 0.13746982091054, 0.266805330335791, 
        0.0305377812098308, 0.100361808799063, 0.0166445822416418, -0.0679924726685577, -0.114329003278327, -0.119124565575224, 
        -0.132545980748995, -0.109352434185848, -0.0811898207877757, -0.255899030306301, -0.286982185702862, -0.286982185702862), 
        .Dim = c(33L, 3L), .Dimnames = list(c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", 
            "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33"), 
            c("agabsent", "agpresent", "log10(wbc)"))), rank = 3L, qraux = c(1, 1.24253562503633, 1.06806024797878), pivot = 1:3, 
        tol = 1e-11), class = "qr"), family = structure(list(family = "Gamma", link = "log", linkfun = genthat::with_env(function(mu) log(mu), 
        env = getNamespace("stats")), linkinv = genthat::with_env(function(eta) pmax(exp(eta), .Machine$double.eps), env = getNamespace("stats")), 
        variance = genthat::with_env(function(mu) mu^2, env = list2env(list(), parent = baseenv())), dev.resids = genthat::with_env(function(y, 
            mu, wt) -2 * wt * (log(ifelse(y == 0, 1, y/mu)) - (y - mu)/mu), env = list2env(list(), parent = baseenv())), 
        aic = genthat::with_env(function(y, n, mu, wt, dev) {
            n <- sum(wt)
            disp <- dev/n
            -2 * sum(dgamma(y, 1/disp, scale = mu * disp, log = TRUE) * wt) + 2
        }, env = list2env(list(dgamma = stats::dgamma), parent = baseenv())), mu.eta = genthat::with_env(function(eta) pmax(exp(eta), 
            .Machine$double.eps), env = getNamespace("stats")), initialize = expression({
            if (any(y <= 0)) stop("non-positive values not allowed for the 'gamma' family")
            n <- rep.int(1, nobs)
            mustart <- y
        }), validmu = genthat::with_env(function(mu) all(is.finite(mu)) && all(mu > 0), env = list2env(list(), parent = baseenv())), 
        valideta = genthat::with_env(function(eta) TRUE, env = getNamespace("stats")), simulate = genthat::with_env(function(object, 
            nsim) {
            wts <- object$prior.weights
            if (any(wts != 1)) message("using weights as shape parameters")
            ftd <- fitted(object)
            shape <- MASS::gamma.shape(object)$alpha * wts
            rgamma(nsim * length(ftd), shape = shape, rate = shape/ftd)
        }, env = list2env(list(rgamma = stats::rgamma, fitted = stats::fitted), parent = baseenv()))), class = "family"), 
        linear.predictors = structure(c(4.47679477289706, 4.81790318237808, 4.28632964596212, 4.43947457686147, 4.18492034277413, 
            4.01457307239671, 4.02942481794555, 3.86790136542278, 4.21699212601327, 4.13799681398615, 4.04825971566308, 3.67536124475962, 
            3.64808326770015, 3.32851699179157, 3.32851699179157, 3.5275724708395, 3.32851699179157, 3.26168640779834, 3.37826940304981, 
            3.29069886477126, 3.58926368291779, 3.04385138159239, 3.20503679920956, 3.01177959835325, 2.81639901787681, 2.70943336013498, 
            2.69836303465788, 2.66738034167253, 2.72092153111519, 2.78593357293643, 2.38262574509995, 2.31087177219927, 2.31087177219927), 
            names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", 
                "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33")), deviance = 40.3190891159466, 
        aic = 301.487107991973, null.deviance = 2445.2380398834, iter = 8L, weights = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), names = c("1", "2", "3", "4", "5", 
            "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", 
            "25", "26", "27", "28", "29", "30", "31", "32", "33")), prior.weights = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 
            1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), names = c("1", "2", "3", "4", "5", "6", 
            "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", 
            "26", "27", "28", "29", "30", "31", "32", "33")), df.residual = 30L, df.null = 33L, y = structure(c(65L, 156L, 
            100L, 134L, 16L, 108L, 121L, 4L, 39L, 143L, 56L, 26L, 22L, 1L, 1L, 5L, 65L, 56L, 65L, 17L, 7L, 16L, 22L, 3L, 
            4L, 2L, 3L, 8L, 4L, 3L, 30L, 4L, 43L), names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", 
            "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", 
            "32", "33")), converged = TRUE, boundary = FALSE, model = structure(list(time = c(65L, 156L, 100L, 134L, 16L, 
            108L, 121L, 4L, 39L, 143L, 56L, 26L, 22L, 1L, 1L, 5L, 65L, 56L, 65L, 17L, 7L, 16L, 22L, 3L, 4L, 2L, 3L, 8L, 4L, 
            3L, 30L, 4L, 43L), ag = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 
            1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("absent", "present"), class = "factor"), 
            `log10(wbc)` = c(3.36172783601759, 2.8750612633917, 3.63346845557959, 3.41497334797082, 3.77815125038364, 4.02118929906994, 
                4, 4.23044892137827, 3.73239375982297, 3.84509804001426, 3.9731278535997, 4.50514997831991, 4.54406804435028, 
                5, 5, 4.7160033436348, 5, 3.64345267648619, 3.47712125471966, 3.60205999132796, 3.17609125905568, 3.95424250943932, 
                3.72427586960079, 4, 4.27875360095283, 4.43136376415899, 4.44715803134222, 4.49136169383427, 4.41497334797082, 
                4.32221929473392, 4.89762709129044, 5, 5)), terms = time ~ ag - 1 + log10(wbc), row.names = c(NA, 33L), class = "data.frame"), 
        call = glm(formula = time ~ ag - 1 + log10(wbc), family = Gamma(log), data = leuk), formula = time ~ ag - 1 + log10(wbc), 
        terms = time ~ ag - 1 + log10(wbc), data = structure(list(wbc = c(2300L, 750L, 4300L, 2600L, 6000L, 10500L, 10000L, 
            17000L, 5400L, 7000L, 9400L, 32000L, 35000L, 100000L, 100000L, 52000L, 100000L, 4400L, 3000L, 4000L, 1500L, 9000L, 
            5300L, 10000L, 19000L, 27000L, 28000L, 31000L, 26000L, 21000L, 79000L, 100000L, 100000L), ag = structure(c(2L, 
            2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
            1L, 1L, 1L, 1L), .Label = c("absent", "present"), class = "factor"), time = c(65L, 156L, 100L, 134L, 16L, 108L, 
            121L, 4L, 39L, 143L, 56L, 26L, 22L, 1L, 1L, 5L, 65L, 56L, 65L, 17L, 7L, 16L, 22L, 3L, 4L, 2L, 3L, 8L, 4L, 3L, 
            30L, 4L, 43L)), class = "data.frame", row.names = c(NA, 33L)), offset = NULL, control = list(epsilon = 1e-08, 
            maxit = 25, trace = FALSE), method = "glm.fit", contrasts = list(ag = "contr.treatment"), xlevels = list(ag = c("absent", 
            "present"))), class = c("glm", "lm"))
    leuk.diag <- list(res = structure(c(-0.28952697084958, 0.262330871751513, 0.339544330928018, 0.511399665856822, -1.1155660215845, 
        0.755407455117101, 0.886770476913263, -1.71105208588773, -0.498792316454066, 0.971613195404049, -0.0225612295183631, 
        -0.385396412763606, -0.502975862960535, -2.11656177443375, -2.11656177443375, -1.42404517858585, 1.06873812403075, 
        0.906150713119457, 0.968701954177849, -0.42293503917581, -1.28386911960613, -0.256244757953623, -0.111592734603682, 
        -1.41324167121044, -1.12554106431582, -1.47111992472208, -1.23190314289659, -0.526954768672581, -1.06561839826104, 
        -1.28296861485309, 1.31773864765438, -0.798996633124528, 2.17513822324039), names = c("1", "2", "3", "4", "5", "6", 
        "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", 
        "27", "28", "29", "30", "31", "32", "33")), rd = structure(c(-0.292370835371451, 0.258044441068645, 0.336339614874583, 
        0.501975422664316, -1.1376312178849, 0.742332384684226, 0.868294274836787, -1.75022659651952, -0.504128693103617, 
        0.947486593700876, -0.022571511724656, -0.388810155594543, -0.508876011366912, -2.24077927244779, -2.24077927244779, 
        -1.47040110075702, 1.01396964872044, 0.87856501967212, 0.931291963125438, -0.428033432796716, -1.34945458288335, 
        -0.257649920790427, -0.111924116486253, -1.44466808159157, -1.1463690624882, -1.50619274877626, -1.25840508050832, 
        -0.532914580767988, -1.08586168742741, -1.30934287883221, 1.24542833424855, -0.821506788345396, 1.95214757612464), 
        names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", 
            "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33")), rp = structure(c(-0.265012035336176, 
        0.27920194652888, 0.375103613114964, 0.588221025993044, -0.751331581490869, 0.938658505838661, 1.13901486147273, 
        -0.906511055350682, -0.422816439617991, 1.27051365449412, -0.0224001385509183, -0.339975911692955, -0.426332758395991, 
        -0.993512393580622, -0.993512393580622, -0.859513436949286, 1.37050351626469, 1.15132379769019, 1.23536207578411, 
        -0.369653217313509, -0.841507672989832, -0.235859315521249, -0.107789992622658, -0.845430295761425, -0.753690332543239, 
        -0.861128056630813, -0.79310738248781, -0.442336912960134, -0.731589836110126, -0.807879262524623, 1.79831841756579, 
        -0.618287903883206, 3.3456100940483), names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", 
        "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", 
        "33")), cook = structure(c(0.00284972340084823, 0.00634396221036542, 0.00399758578982234, 0.0130392210186998, 0.0137577538161879, 
        0.0185266806132143, 0.0274428014668273, 0.0176367979106237, 0.00455484251899663, 0.0371744344248268, 1.07163643887405e-05, 
        0.00309064973792562, 0.00507835404461712, 0.05098706995984, 0.05098706995984, 0.0256303345626849, 0.0970227958892265, 
        0.043124037152675, 0.0615212017138001, 0.00467937508965494, 0.0433604260632737, 0.00133477630173216, 0.000343855021313127, 
        0.0166847765896293, 0.012821959853026, 0.0181430641155813, 0.015573411256304, 0.00502288817353547, 0.0129434627245166, 
        0.0149741254324109, 0.133419155018491, 0.0181489918964403, 0.531400132200879), names = c("1", "2", "3", "4", "5", 
        "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", 
        "26", "27", "28", "29", "30", "31", "32", "33")), h = c(0.108518794332649, 0.196234121012828, 0.0785403571287948, 
        0.101572228480472, 0.0681332807266511, 0.0593385559150871, 0.0596719601111916, 0.0604916496260476, 0.0710073293428176, 
        0.0646239077936072, 0.0602138450615127, 0.0742613984517971, 0.0773374281003384, 0.134173194281355, 0.134173194281355, 
        0.0942691024708989, 0.134173194281355, 0.0889205152671624, 0.107888836387766, 0.0931641475475195, 0.155188172993153, 
        0.0671484816800159, 0.0815450494500769, 0.0654470323061771, 0.063421151585524, 0.0683808974681421, 0.0691394095513575, 
        0.0715067667950161, 0.0676423873027983, 0.0643964132611458, 0.110136134113762, 0.124670531445812, 0.124670531445812), 
        sd = 1.0429356258197)
    boot:::glm.diag.plots(glmfit = leuk.mod, glmdiag = leuk.diag)
}




