library(class)

function_to_run <- function() {
    lcrabs <- structure(list(FL = c(2.09186406167839, 2.17475172148416, 2.21920348405499, 2.26176309847379, 2.28238238567653, 
        2.37954613413017, 2.40694510831829, 2.45100509811232, 2.46809953147162, 2.46809953147162, 2.50143595173921, 2.50959926237837, 
        2.53369681395743, 2.54944517092557, 2.54944517092557, 2.55722731136763, 2.57261223020711, 2.57261223020711, 2.58776403522771, 
        2.63188884013665, 2.66025953726586, 2.68102152871429, 2.70805020110221, 2.70805020110221, 2.70805020110221, 2.72129542785223, 
        2.73436750941958, 2.75366071235426, 2.76631910922619, 2.77881927199042, 2.77881927199042, 2.78501124223834, 2.79116510781272, 
        2.79728133483015, 2.8094026953625, 2.82137888640921, 2.82731362192903, 2.83907846350861, 2.83907846350861, 2.84490938381941, 
        2.87356463957978, 2.88480071284671, 2.89037175789616, 2.9338568698359, 2.96010509591084, 2.96010509591084, 2.98061863574394, 
        2.98568193770049, 2.98568193770049, 3.05870707271538, 1.97408102602201, 2.19722457733622, 2.2082744135228, 2.2082744135228, 
        2.2512917986065, 2.28238238567653, 2.31253542384721, 2.33214389523559, 2.34180580614733, 2.37954613413017, 2.39789527279837, 
        2.41591377830105, 2.4423470353692, 2.45100509811232, 2.45100509811232, 2.45958884180371, 2.47653840011748, 2.484906649788, 
        2.484906649788, 2.53369681395743, 2.54944517092557, 2.54944517092557, 2.54944517092557, 2.56494935746154, 2.57261223020711, 
        2.58021682959233, 2.59525470695687, 2.61739583283408, 2.63188884013665, 2.68784749378469, 2.70136121295141, 2.70805020110221, 
        2.70805020110221, 2.71469474382088, 2.71469474382088, 2.71469474382088, 2.72129542785223, 2.72785282839839, 2.73436750941958, 
        2.7408400239252, 2.74727091425549, 2.74727091425549, 2.75366071235426, 2.76000994003292, 2.78501124223834, 2.79728133483015, 
        2.81540871942271, 2.85647020622048, 2.86220088092947, 2.95491027903374, 2.2082744135228, 2.32238772029023, 2.37024374146786, 
        2.43361335540045, 2.52572864430826, 2.52572864430826, 2.54160199346455, 2.58021682959233, 2.59525470695687, 2.61739583283408, 
        2.63905732961526, 2.64617479738412, 2.64617479738412, 2.64617479738412, 2.65324196460721, 2.65324196460721, 2.65324196460721, 
        2.68102152871429, 2.68784749378469, 2.71469474382088, 2.71469474382088, 2.73436750941958, 2.75366071235426, 2.78501124223834, 
        2.79116510781272, 2.83907846350861, 2.85647020622048, 2.86220088092947, 2.86220088092947, 2.87919845729804, 2.88480071284671, 
        2.89037175789616, 2.90142159408275, 2.91235066461494, 2.92316158071916, 2.92316158071916, 2.9338568698359, 2.9338568698359, 
        2.96527306606928, 2.96527306606928, 3.00071981506503, 3.02529107579554, 3.04452243772342, 3.06805293513362, 3.07269331469012, 
        3.07269331469012, 3.08648663682246, 3.09557760852371, 3.13549421592915, 3.13983261752775, 2.37024374146786, 2.43361335540045, 
        2.52572864430826, 2.53369681395743, 2.55722731136763, 2.63905732961526, 2.63905732961526, 2.66025953726586, 2.68784749378469, 
        2.70136121295141, 2.70805020110221, 2.74727091425549, 2.74727091425549, 2.74727091425549, 2.75366071235426, 2.77881927199042, 
        2.77881927199042, 2.78501124223834, 2.81540871942271, 2.83907846350861, 2.86220088092947, 2.86220088092947, 2.86220088092947, 
        2.86789890204411, 2.89037175789616, 2.89037175789616, 2.90690105984738, 2.91235066461494, 2.91235066461494, 2.91777073208428, 
        2.92316158071916, 2.9338568698359, 2.9391619220656, 2.94968833505258, 2.94968833505258, 2.98061863574394, 2.99071973173045, 
        2.99071973173045, 2.99573227355399, 3.00071981506503, 3.01062088604774, 3.02042488614436, 3.02529107579554, 3.03974915897077, 
        3.05870707271538, 3.06339092202781, 3.07731226054641, 3.08648663682246, 3.11351530921037, 3.13983261752775), RW = c(1.90210752639692, 
        2.04122032885964, 2.05412373369555, 2.06686275947298, 2.07944154167984, 2.19722457733622, 2.29253475714054, 2.2082744135228, 
        2.26176309847379, 2.35137525716348, 2.37954613413017, 2.39789527279837, 2.30258509299405, 2.32238772029023, 2.3887627892351, 
        2.39789527279837, 2.36085400111802, 2.3887627892351, 2.40694510831829, 2.40694510831829, 2.45100509811232, 2.42480272571829, 
        2.3887627892351, 2.4423470353692, 2.47653840011748, 2.4932054526027, 2.46809953147162, 2.53369681395743, 2.54160199346455, 
        2.45100509811232, 2.54944517092557, 2.58776403522771, 2.54160199346455, 2.56494935746154, 2.60268968544438, 2.54944517092557, 
        2.58021682959233, 2.53369681395743, 2.54160199346455, 2.60268968544438, 2.61006979274201, 2.64617479738412, 2.61739583283408, 
        2.76000994003292, 2.60268968544438, 2.62466859216316, 2.72785282839839, 2.65324196460721, 2.66025953726586, 2.75366071235426, 
        1.87180217690159, 2.14006616349627, 2.09186406167839, 2.10413415427021, 2.10413415427021, 2.18605127673809, 2.23001440015921, 
        2.2512917986065, 2.27212588550934, 2.2512917986065, 2.28238238567653, 2.30258509299405, 2.39789527279837, 2.39789527279837, 
        2.43361335540045, 2.36085400111802, 2.43361335540045, 2.37024374146786, 2.40694510831829, 2.50143595173921, 2.45958884180371, 
        2.50143595173921, 2.50143595173921, 2.43361335540045, 2.4423470353692, 2.50143595173921, 2.46809953147162, 2.52572864430826, 
        2.56494935746154, 2.52572864430826, 2.58021682959233, 2.62466859216316, 2.65324196460721, 2.58776403522771, 2.60268968544438, 
        2.62466859216316, 2.66025953726586, 2.65324196460721, 2.58776403522771, 2.62466859216316, 2.63188884013665, 2.68784749378469, 
        2.63188884013665, 2.70805020110221, 2.72129542785223, 2.63905732961526, 2.77881927199042, 2.82731362192903, 2.81540871942271, 
        2.80336038090653, 1.93152141160321, 2.10413415427021, 2.15176220325946, 2.19722457733622, 2.24070968927596, 2.24070968927596, 
        2.34180580614733, 2.39789527279837, 2.31253542384721, 2.39789527279837, 2.4423470353692, 2.34180580614733, 2.35137525716348, 
        2.37024374146786, 2.36085400111802, 2.37024374146786, 2.42480272571829, 2.42480272571829, 2.40694510831829, 2.43361335540045, 
        2.4423470353692, 2.40694510831829, 2.50143595173921, 2.46809953147162, 2.45100509811232, 2.53369681395743, 2.54944517092557, 
        2.484906649788, 2.54160199346455, 2.52572864430826, 2.55722731136763, 2.59525470695687, 2.61739583283408, 2.59525470695687, 
        2.59525470695687, 2.60268968544438, 2.59525470695687, 2.62466859216316, 2.64617479738412, 2.66722820658195, 2.61739583283408, 
        2.66722820658195, 2.70805020110221, 2.7408400239252, 2.73436750941958, 2.69462718077007, 2.75366071235426, 2.76000994003292, 
        2.82137888640921, 2.75366071235426, 2.27212588550934, 2.21920348405499, 2.30258509299405, 2.4423470353692, 2.41591377830105, 
        2.47653840011748, 2.54944517092557, 2.50143595173921, 2.58021682959233, 2.56494935746154, 2.50959926237837, 2.60268968544438, 
        2.63905732961526, 2.64617479738412, 2.61006979274201, 2.61006979274201, 2.61739583283408, 2.63905732961526, 2.66025953726586, 
        2.67414864942653, 2.66025953726586, 2.66722820658195, 2.68784749378469, 2.63905732961526, 2.70136121295141, 2.79116510781272, 
        2.75366071235426, 2.7408400239252, 2.75366071235426, 2.68102152871429, 2.67414864942653, 2.72129542785223, 2.81540871942271, 
        2.77258872223978, 2.79116510781272, 2.81540871942271, 2.8094026953625, 2.88480071284671, 2.81540871942271, 2.84490938381941, 
        2.77258872223978, 2.86220088092947, 2.86220088092947, 2.80336038090653, 2.91235066461494, 2.89037175789616, 2.83907846350861, 
        2.84490938381941, 2.84490938381941, 3.00568260440716), CL = c(2.77881927199042, 2.89591193827178, 2.94443897916644, 
        3.00071981506503, 3.01062088604774, 3.13549421592915, 3.16968558067743, 3.19867311755068, 3.18635263316264, 3.22684399451738, 
        3.30688670219091, 3.28840188751681, 3.32143241319329, 3.30321697330195, 3.31054301339402, 3.28840188751681, 3.33932197794407, 
        3.34286180464919, 3.32503602069659, 3.37416870927424, 3.44361809754611, 3.4626060097908, 3.44680789291421, 3.47815842279828, 
        3.48124008933569, 3.47506723022861, 3.49650756146648, 3.57794789340665, 3.52636052461616, 3.52046080248897, 3.55248682920838, 
        3.58351893845611, 3.57234563785798, 3.57515068878559, 3.64021428213266, 3.58905911883173, 3.61899332664977, 3.5945687746427, 
        3.60277675506052, 3.62700405039585, 3.65583960003574, 3.68135118769314, 3.66867674679642, 3.74004774068834, 3.72810016726722, 
        3.71113006304876, 3.73528582692809, 3.76584049525006, 3.74714836223791, 3.85227300102237, 2.68784749378469, 2.96010509591084, 
        2.91777073208428, 2.95491027903374, 2.97552956623647, 3.01553490085017, 3.03974915897077, 3.05870707271538, 3.07731226054641, 
        3.11351530921037, 3.11351530921037, 3.1267605359604, 3.20680324363393, 3.20274644293832, 3.16547504814109, 3.21486780347066, 
        3.25809653802148, 3.20274644293832, 3.23474917402449, 3.26193531432865, 3.29953372788566, 3.2846635654062, 3.32862668882732, 
        3.30688670219091, 3.3178157727231, 3.32862668882732, 3.34638914516716, 3.35340671782581, 3.40119738166216, 3.40452517175483, 
        3.40452517175483, 3.45631668088323, 3.4904285153901, 3.45946628978613, 3.4626060097908, 3.45631668088323, 3.5234150143864, 
        3.48431228837266, 3.47815842279828, 3.50855589998265, 3.4904285153901, 3.5234150143864, 3.51452606696916, 3.54095932403731, 
        3.54095932403731, 3.53222564406856, 3.60004824040732, 3.64283551561253, 3.65325227647079, 3.71113006304876, 2.81540871942271, 
        3.00568260440716, 3.03013370027132, 3.12236492448736, 3.14415227867226, 3.18635263316264, 3.25809653802148, 3.29953372788566, 
        3.28091121578765, 3.31418600467253, 3.37416870927424, 3.36384159511839, 3.37073817417745, 3.35689712276558, 3.35689712276558, 
        3.32503602069659, 3.37416870927424, 3.39785848039664, 3.36729582998647, 3.40784192438082, 3.4307561839037, 3.40784192438082, 
        3.45631668088323, 3.47506723022861, 3.45315712059287, 3.55534806148941, 3.58629286533884, 3.53805656437935, 3.54385368206368, 
        3.58351893845611, 3.60821155104648, 3.60277675506052, 3.65842024662923, 3.63495111208838, 3.63230910262554, 3.60821155104648, 
        3.6163087612791, 3.66867674679642, 3.66612246699132, 3.68386691229039, 3.70376806660769, 3.75653810258775, 3.75887182593397, 
        3.8177123259569, 3.82209829790016, 3.77045944110636, 3.8155121050473, 3.79773385902602, 3.85439389259151, 3.86283276123737, 
        3.06339092202781, 3.07731226054641, 3.18221184049661, 3.2188758248682, 3.25037449192757, 3.29583686600433, 3.3603753871419, 
        3.3357695763397, 3.38777436133001, 3.40119738166216, 3.40452517175483, 3.44041809481544, 3.45315712059287, 3.43398720448515, 
        3.43398720448515, 3.45315712059287, 3.44680789291421, 3.45315712059287, 3.47506723022861, 3.49953328238302, 3.54095932403731, 
        3.54095932403731, 3.5055573969864, 3.52636052461616, 3.54673968695281, 3.63495111208838, 3.55820113047182, 3.57234563785798, 
        3.59731226058845, 3.61091791264422, 3.54673968695281, 3.57794789340665, 3.5918177412708, 3.63230910262554, 3.63495111208838, 
        3.68637632389582, 3.67376581630389, 3.69137633431252, 3.6988297849671, 3.68386691229039, 3.67376581630389, 3.68887945411394, 
        3.72569342723665, 3.68637632389582, 3.7796338173824, 3.71843825635548, 3.73050112880476, 3.75185425327532, 3.76120011569356, 
        3.83297979808769), CW = c(2.94443897916644, 3.03495298670727, 3.10906095886099, 3.13983261752775, 3.13549421592915, 
        3.27714473299218, 3.29953372788566, 3.34638914516716, 3.32503602069659, 3.37758751602302, 3.45315712059287, 3.44998754583159, 
        3.45631668088323, 3.45946628978613, 3.44998754583159, 3.4307561839037, 3.47506723022861, 3.47815842279828, 3.47506723022861, 
        3.5055573969864, 3.56953269648137, 3.5945687746427, 3.5945687746427, 3.61091791264422, 3.6163087612791, 3.60277675506052, 
        3.62434093297637, 3.69635146895264, 3.6609942506244, 3.66356164612965, 3.70622809244855, 3.73050112880476, 3.71113006304876, 
        3.73289633953071, 3.77045944110636, 3.73289633953071, 3.75419892023458, 3.73766961828337, 3.73528582692809, 3.78191432008113, 
        3.79548918917219, 3.79773385902602, 3.79323946943818, 3.89182029811063, 3.85862222870103, 3.83945231259331, 3.88156379794344, 
        3.90600493310258, 3.88977739648083, 4.00003388275086, 2.83907846350861, 3.12236492448736, 3.07269331469012, 3.10009228887823, 
        3.10906095886099, 3.17387845893747, 3.19458313229916, 3.20680324363393, 3.23474917402449, 3.26956893918372, 3.24649099190117, 
        3.29212628660779, 3.37416870927424, 3.3499040872746, 3.32143241319329, 3.3499040872746, 3.40452517175483, 3.36384159511839, 
        3.37416870927424, 3.45315712059287, 3.44041809481544, 3.43720781918519, 3.4626060097908, 3.45946628978613, 3.48431228837266, 
        3.46885603013597, 3.48737507790321, 3.52046080248897, 3.55248682920838, 3.54673968695281, 3.57234563785798, 3.60821155104648, 
        3.62167070442049, 3.5918177412708, 3.61091791264422, 3.60004824040732, 3.65065824129374, 3.6454498961866, 3.62700405039585, 
        3.65583960003574, 3.63495111208838, 3.67630067190708, 3.65065824129374, 3.69635146895264, 3.69137633431252, 3.68386691229039, 
        3.73528582692809, 3.7864597824528, 3.79548918917219, 3.86911550441687, 2.92316158071916, 3.10009228887823, 3.12236492448736, 
        3.21084365317094, 3.25809653802148, 3.29583686600433, 3.3603753871419, 3.41444260841218, 3.38777436133001, 3.41772668361337, 
        3.47196645255036, 3.45946628978613, 3.45315712059287, 3.4626060097908, 3.45631668088323, 3.4307561839037, 3.47196645255036, 
        3.51154543883102, 3.46885603013597, 3.5055573969864, 3.52636052461616, 3.51452606696916, 3.53222564406856, 3.56388296393925, 
        3.53222564406856, 3.6609942506244, 3.67630067190708, 3.61899332664977, 3.64805745959368, 3.68386691229039, 3.71113006304876, 
        3.72086249996699, 3.75419892023458, 3.74242022104197, 3.73528582692809, 3.69386699562498, 3.71600812150219, 3.76815263500844, 
        3.76584049525006, 3.79098467705109, 3.79548918917219, 3.83945231259331, 3.85439389259151, 3.90600493310258, 3.90600493310258, 
        3.87535902105655, 3.93182563272433, 3.90399083373088, 3.95316494875932, 3.96651119071222, 3.17805383034795, 3.18221184049661, 
        3.29583686600433, 3.3357695763397, 3.37073817417745, 3.44680789291421, 3.47815842279828, 3.45946628978613, 3.50855589998265, 
        3.51749783735832, 3.5055573969864, 3.55820113047182, 3.56388296393925, 3.54095932403731, 3.54961738678043, 3.58351893845611, 
        3.58629286533884, 3.57234563785798, 3.61091791264422, 3.6163087612791, 3.67882911826043, 3.66356164612965, 3.62700405039585, 
        3.65325227647079, 3.67630067190708, 3.76120011569356, 3.70130197411249, 3.68887945411394, 3.72810016726722, 3.73766961828337, 
        3.67376581630389, 3.70130197411249, 3.73050112880476, 3.74478708605223, 3.75185425327532, 3.77505715035499, 3.78191432008113, 
        3.83729945923221, 3.80888224650863, 3.7864597824528, 3.7864597824528, 3.8177123259569, 3.83297979808769, 3.79997350161952, 
        3.87949981372259, 3.83297979808769, 3.85439389259151, 3.85862222870103, 3.88567903008854, 3.96081316959758), BD = c(1.94591014905531, 
        2.00148000021012, 2.04122032885964, 2.10413415427021, 2.10413415427021, 2.28238238567653, 2.28238238567653, 2.34180580614733, 
        2.27212588550934, 2.33214389523559, 2.3887627892351, 2.43361335540045, 2.43361335540045, 2.3887627892351, 2.39789527279837, 
        2.43361335540045, 2.39789527279837, 2.41591377830105, 2.42480272571829, 2.4932054526027, 2.54160199346455, 2.61739583283408, 
        2.58021682959233, 2.59525470695687, 2.61006979274201, 2.61006979274201, 2.61006979274201, 2.67414864942653, 2.65324196460721, 
        2.66722820658195, 2.75366071235426, 2.73436750941958, 2.70136121295141, 2.72129542785223, 2.70136121295141, 2.70136121295141, 
        2.74727091425549, 2.71469474382088, 2.74727091425549, 2.77881927199042, 2.77258872223978, 2.82137888640921, 2.78501124223834, 
        2.87919845729804, 2.87919845729804, 2.82137888640921, 2.87919845729804, 2.92316158071916, 2.90690105984738, 2.99573227355399, 
        1.80828877117927, 2.04122032885964, 2.04122032885964, 2.04122032885964, 2.05412373369555, 2.17475172148416, 2.12823170584927, 
        2.18605127673809, 2.11625551480255, 2.2082744135228, 2.10413415427021, 2.24070968927596, 2.31253542384721, 2.34180580614733, 
        2.30258509299405, 2.34180580614733, 2.3887627892351, 2.35137525716348, 2.39789527279837, 2.41591377830105, 2.47653840011748, 
        2.40694510831829, 2.4423470353692, 2.42480272571829, 2.40694510831829, 2.4423470353692, 2.45958884180371, 2.47653840011748, 
        2.57261223020711, 2.52572864430826, 2.484906649788, 2.63905732961526, 2.63905732961526, 2.60268968544438, 2.62466859216316, 
        2.56494935746154, 2.68784749378469, 2.62466859216316, 2.62466859216316, 2.68784749378469, 2.59525470695687, 2.66025953726586, 
        2.64617479738412, 2.72785282839839, 2.63188884013665, 2.72129542785223, 2.73436750941958, 2.8094026953625, 2.83321334405622, 
        2.89591193827178, 2.00148000021012, 2.19722457733622, 2.21920348405499, 2.31253542384721, 2.37954613413017, 2.41591377830105, 
        2.4932054526027, 2.50143595173921, 2.484906649788, 2.50143595173921, 2.57261223020711, 2.60268968544438, 2.57261223020711, 
        2.58776403522771, 2.55722731136763, 2.54160199346455, 2.60268968544438, 2.54944517092557, 2.57261223020711, 2.63905732961526, 
        2.63188884013665, 2.60268968544438, 2.65324196460721, 2.68784749378469, 2.67414864942653, 2.75366071235426, 2.78501124223834, 
        2.72785282839839, 2.77881927199042, 2.81540871942271, 2.80336038090653, 2.83907846350861, 2.84490938381941, 2.87356463957978, 
        2.85070650150373, 2.83321334405622, 2.86220088092947, 2.88480071284671, 2.87919845729804, 2.88480071284671, 2.89037175789616, 
        2.97552956623647, 2.96527306606928, 3.03974915897077, 3.02529107579554, 3.00071981506503, 3.04927304048202, 3.02042488614436, 
        3.06805293513362, 3.07269331469012, 2.28238238567653, 2.27212588550934, 2.3887627892351, 2.4423470353692, 2.47653840011748, 
        2.53369681395743, 2.54160199346455, 2.52572864430826, 2.55722731136763, 2.58776403522771, 2.63905732961526, 2.64617479738412, 
        2.62466859216316, 2.62466859216316, 2.62466859216316, 2.63905732961526, 2.63188884013665, 2.61739583283408, 2.68784749378469, 
        2.68102152871429, 2.74727091425549, 2.77258872223978, 2.68102152871429, 2.7408400239252, 2.75366071235426, 2.84490938381941, 
        2.77881927199042, 2.76631910922619, 2.79728133483015, 2.8094026953625, 2.70805020110221, 2.8094026953625, 2.72785282839839, 
        2.82137888640921, 2.84490938381941, 2.90142159408275, 2.88480071284671, 2.88480071284671, 2.87356463957978, 2.92316158071916, 
        2.89037175789616, 2.95491027903374, 2.95491027903374, 2.86220088092947, 2.99573227355399, 2.92852352386054, 2.97552956623647, 
        2.9704144655697, 2.98568193770049, 3.04927304048202)), row.names = c(NA, 200L), class = "data.frame")
    gr <- structure(list(pts = structure(c(1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 1, 2, 3, 4, 5, 6, 7, 8, 1.5, 2.5, 3.5, 
        4.5, 5.5, 6.5, 7.5, 8.5, 1, 2, 3, 4, 5, 6, 7, 8, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 1, 2, 3, 4, 5, 6, 7, 8, 
        0.866025403784439, 0.866025403784439, 0.866025403784439, 0.866025403784439, 0.866025403784439, 0.866025403784439, 
        0.866025403784439, 0.866025403784439, 1.73205080756888, 1.73205080756888, 1.73205080756888, 1.73205080756888, 1.73205080756888, 
        1.73205080756888, 1.73205080756888, 1.73205080756888, 2.59807621135332, 2.59807621135332, 2.59807621135332, 2.59807621135332, 
        2.59807621135332, 2.59807621135332, 2.59807621135332, 2.59807621135332, 3.46410161513775, 3.46410161513775, 3.46410161513775, 
        3.46410161513775, 3.46410161513775, 3.46410161513775, 3.46410161513775, 3.46410161513775, 4.33012701892219, 4.33012701892219, 
        4.33012701892219, 4.33012701892219, 4.33012701892219, 4.33012701892219, 4.33012701892219, 4.33012701892219, 5.19615242270663, 
        5.19615242270663, 5.19615242270663, 5.19615242270663, 5.19615242270663, 5.19615242270663, 5.19615242270663, 5.19615242270663), 
        .Dim = c(48L, 2L), .Dimnames = list(NULL, c("x", "y"))), xdim = 8, ydim = 6, topo = "hexagonal"), class = "somgrid")
    class:::batchSOM(data = lcrabs, grid = gr, radii = c(4, 4, 2, 2, 1, 1, 1, 0, 0))
}




