library(emplik)

function_to_run <- function() {
    z <- structure(c(0.905923344947735, -4.11149825783972, 0.975609756097561, 1.04529616724739, 0.766550522648084, 0.836236933797909, 
        0.48780487804878, 0.557491289198606, 1.25435540069686, 0.0696864111498258, 0.627177700348432, 0.975609756097561, 
        0.627177700348432, 1.74216027874564, 0.418118466898955, 1.11498257839721, 1.32404181184669, -1.18466898954704, 0.696864111498258, 
        0.278745644599303), .Dim = c(20L, 1L))
    p <- 1L
    nwts <- c(1, 0.333333333333333, 0.111111111111111, 0.037037037037037, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    nstep <- -0.0174904442613314
    lam <- 0.178071270491986
    i <- 1L
    gwts <- c(0, 0.372677996249965, 0.223951604119404, 0.119387008872478, 0.0625, 0.03125, 0.015625, 0.0078125, 0.00390625, 
        0.001953125, 0.0009765625, 4.8828125e-05, 2.44140625e-06, 1.220703125e-07, 6.103515625e-09, 3.0517578125e-10)
    gstep <- -0.0174904442613314
    emplik:::logelr(x = z, mu = rep(0, p), lam = lam + nwts[i] * nstep + gwts[i] * gstep)
}




