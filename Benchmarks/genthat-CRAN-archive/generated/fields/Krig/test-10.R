library(fields)

function_to_run <- function() {
    m <- 2
    ltheta <- 1.50464799752971
    info <- list(x = structure(list(lon = c(-109.1, -103.17, -105.85, -105.53, -105.88, -106.83, -105.48, -105.78, -105.52, 
        -102.18, -105.27, -104.33, -104.83, -108.92, -106.13, -102.27, -104.22, -105.7, -105.23, -104.87, -107.93, -106.12, 
        -105.28, -104.85, -102.35, -107.52, -106.2, -106.77, -107.97, -108.73, -104.7, -108.57, -106.97, -104.02, -106.35, 
        -108.07, -104.88, -106.03, -108.97, -107.88, -102.78, -106.83, -104.55, -105.52, -105.32, -103.68, -105.08, -108.05, 
        -104.72, -103.8, -108.75, -107.32, -108.53, -108.58, -105.83, -105.85, -108.05, -105.68, -105.53, -104.7, -106.33, 
        -106.97, -107.25, -107.13, -102.12, -102.3, -106.13, -107.63, -102.93, -102.25, -105.1, -103.9, -102.78, -106.4, 
        -103.52, -107.32, -105.48, -105.13, -102.62, -103.22, -106.3, -103.7, -108.2, -105.07, -105.95, -107.47, -108.08, 
        -107.92, -106.75, -108.5, -106.15, -105.5, -109.03, -105.05, -108.28, -107.68, -107.02, -108.35, -107.58, -104.65, 
        -106.53, -104.5, -108.8, -105.6, -108.03, -107.78, -103.7, -104.08, -104.98, -104.93, -106.13, -106.02, -102.52, 
        -107.67, -106.42, -102.7, -106.83, -103.2, -102.58, -106.37, -104.12, -106.62, -107.87, -104.48, -104.33, -108.73, 
        -107.58, -106.27, -104.8, -102.28, -105.2, -105.48, -106.78, -102.23, -106.9, -108.73, -102.73, -101.05, -101.37, 
        -101.07, -101.9, -101.7, -101.33, -101.75, -101.25, -101.37, -101.38, -101.18, -101.8, -101.75, -101.77, -101.77, 
        -101.35, -101.25, -101.53, -102.08, -102.97, -101.52, -101.63, -103.67, -101.67, -102.63, -101.55, -101.72, -102.33, 
        -102.98, -103.03, -101.02, -101.17, -108, -105.6, -106.58, -103.83, -107, -105.27, -106.73, -108.2, -108.4, -103.62, 
        -104.37, -104.58, -107.62, -104.43, -105.4, -108.73, -106.58, -102.48, -101.62, -101.22, -102.97, -109.07, -109.18, 
        -109.48, -109.18, -109.08, -109.3, -109.42, -109.07, -109.37, -109.33, -104.1, -104.65, -104.32, -106.13, -104.82, 
        -107.53, -106.62, -105.23, -105.68, -105.62, -104.07, -104.15, -106.82), lat = c(36.9, 40.12, 37.43, 40.2, 39, 39.18, 
        39.4, 39.8, 37.43, 39.62, 40, 40.65, 39.98, 40.8, 38.83, 39.3, 39.7, 39.65, 38.42, 39.37, 38.9, 37.75, 39.22, 39.65, 
        38.82, 38.4, 39.38, 38.43, 39.25, 39.1, 38.82, 37.35, 38.87, 37.63, 37.67, 38.75, 39.77, 39.63, 40.23, 37.28, 38.48, 
        39.67, 39.22, 40.38, 39.63, 38.55, 40.58, 37.23, 40.08, 40.22, 39.17, 39.52, 39.12, 39.07, 40.27, 40.25, 39.45, 39.47, 
        37.72, 40.42, 39.88, 38.53, 40.48, 37.77, 38.05, 40.58, 40.05, 37.13, 38.07, 41, 39.5, 40.85, 38.77, 40.07, 38.05, 
        38.05, 38.92, 39.75, 38.08, 38.07, 39.25, 39.18, 40, 40.17, 37.17, 40.03, 40.52, 40.03, 39.37, 37.2, 37.57, 39.98, 
        37.82, 37.22, 38.13, 38.02, 37.27, 39.1, 38.87, 39.52, 38.6, 38.28, 40.08, 40.8, 37.68, 39.52, 38.03, 38.87, 38.85, 
        37.92, 38.08, 38.53, 40.85, 37.8, 40.48, 37.38, 40.5, 40.62, 39.3, 39.25, 38.42, 38.82, 37.95, 37.17, 37.25, 38.37, 
        37.37, 40.73, 37.62, 37.4, 40.42, 38.13, 37.48, 40.07, 40.15, 37.55, 40.12, 39.8, 39.35, 39.38, 37, 39.37, 37.17, 
        37.57, 37.93, 38.48, 39.78, 38.9, 39.77, 38.9, 37.98, 38.47, 37.58, 39.07, 40.05, 41.07, 41.42, 40.42, 40.52, 41.25, 
        41.22, 41.15, 40.85, 41.13, 41.4, 41.13, 41.13, 40.18, 40.83, 36.83, 36.73, 36.92, 36.77, 36.93, 36.57, 36.6, 36.72, 
        36.73, 36.6, 36.98, 36.55, 36.82, 36.92, 36.7, 36.77, 36.72, 36.73, 36.6, 36.87, 36.9, 40.85, 37.22, 37.62, 40.02, 
        37.72, 38.8, 40.93, 37.38, 40.37, 37.87, 41.42, 41.15, 41.05, 41.3, 41.15, 41.03, 41.18, 41.45, 41.32, 41.35, 41.18, 
        41.17, 41.45)), row.names = c(347L, 1012L, 1014L, 1015L, 1017L, 1019L, 1020L, 1021L, 1022L, 1024L, 1025L, 1028L, 
        1029L, 1030L, 1032L, 1033L, 1034L, 1035L, 1038L, 1039L, 1040L, 1041L, 1042L, 1043L, 1044L, 1045L, 1046L, 1047L, 1048L, 
        1049L, 1051L, 1053L, 1055L, 1058L, 1059L, 1060L, 1061L, 1063L, 1064L, 1065L, 1066L, 1067L, 1069L, 1070L, 1071L, 1075L, 
        1077L, 1078L, 1079L, 1080L, 1082L, 1086L, 1087L, 1088L, 1089L, 1090L, 1091L, 1092L, 1093L, 1095L, 1096L, 1099L, 1100L, 
        1101L, 1103L, 1104L, 1105L, 1109L, 1112L, 1114L, 1116L, 1117L, 1120L, 1121L, 1122L, 1124L, 1125L, 1127L, 1128L, 1129L, 
        1130L, 1136L, 1137L, 1140L, 1142L, 1144L, 1146L, 1148L, 1150L, 1151L, 1152L, 1157L, 1160L, 1162L, 1163L, 1167L, 1168L, 
        1169L, 1172L, 1176L, 1178L, 1180L, 1184L, 1185L, 1188L, 1190L, 1192L, 1193L, 1194L, 1195L, 1196L, 1197L, 1204L, 1207L, 
        1208L, 1209L, 1212L, 1213L, 1214L, 1216L, 1218L, 1219L, 1220L, 1222L, 1223L, 1226L, 1228L, 1230L, 1231L, 1232L, 1233L, 
        1234L, 1239L, 1241L, 1242L, 1243L, 1244L, 2476L, 2482L, 2496L, 2508L, 2526L, 2541L, 2553L, 2559L, 2563L, 2572L, 2605L, 
        2607L, 2612L, 2616L, 2621L, 2624L, 2635L, 4195L, 4196L, 4222L, 4227L, 4258L, 4262L, 4263L, 4270L, 4274L, 4301L, 4305L, 
        4318L, 4319L, 4328L, 4334L, 4619L, 4642L, 4644L, 4670L, 4672L, 4674L, 4678L, 4689L, 4700L, 4716L, 4737L, 4755L, 4768L, 
        4792L, 4796L, 4824L, 4835L, 5557L, 5597L, 5612L, 5620L, 6991L, 6997L, 7011L, 7014L, 7036L, 7052L, 7072L, 7096L, 7099L, 
        7134L, 7928L, 7934L, 7955L, 7958L, 7959L, 7980L, 7991L, 8014L, 8035L, 8036L, 8069L, 8070L, 8091L), class = "data.frame"), 
        y = c(19.6611111111111, 15.502380952381, 14.4884615384615, 9.91527777777778, 9.456, 11.5746666666667, 12.7977011494253, 
            2.53015873015873, 14.3827160493827, 16.9166666666667, 15.7944444444444, 17.3157894736842, 17.6955555555556, 16.0698412698413, 
            13.8666666666667, 17.8013888888889, 17.1641025641026, 6.74666666666667, 18.0855555555556, 15.9694444444444, 16.7107142857143, 
            14.4642857142857, 15.1511111111111, 17.0777777777778, 17.1833333333333, 14.1083333333333, 3.8, 11.9288888888889, 
            15.8766666666667, 17.1946666666667, 15.3188888888889, 16.6384615384615, 8.84102564102564, 20.2122807017544, 14.0388888888889, 
            19.8133333333333, 16.4919540229885, 7.98222222222222, 15.6753623188406, 16.0433333333333, 18.6666666666667, 14.6172413793103, 
            14.7020833333333, 11.9271604938272, 13.7820512820513, 18.9511111111111, 15.7422222222222, 12.9452380952381, 17.1333333333333, 
            17.12, 18.8144444444444, 16.1651515151515, 18.6068965517241, 18.4217948717949, 9.58148148148148, 8.58222222222222, 
            18.6333333333333, 10.616, 13.6390804597701, 17.5898550724638, 11.6077777777778, 11.5644444444444, 13.2369047619048, 
            7.92444444444444, 20.2488888888889, 17.797619047619, 11.1055555555556, 16.637037037037, 21.1030303030303, 17.7946666666667, 
            16.76, 15.9938271604938, 19.2333333333333, 12.685, 20.279012345679, 11.4512820512821, 10.3592592592593, 15.5871794871795, 
            20.5166666666667, 20.7044444444444, 6.95490196078431, 15.1117647058824, 14.5095238095238, 16.6885057471264, 14.3544444444444, 
            10.4627450980392, 14.8463768115942, 14.5117647058824, 10.6533333333333, 15.4172839506173, 14.6555555555556, 9.51666666666667, 
            15.0940476190476, 11.9396825396825, 14.2425287356322, 12.2, 14.6266666666667, 19.6259259259259, 17.3264367816092, 
            15.7404761904762, 8.48095238095238, 19.5744444444444, 17.0186666666667, 10.0333333333333, 10.977380952381, 17.4320987654321, 
            20.2811111111111, 15.9666666666667, 8.61264367816092, 15.7782051282051, 13.3444444444444, 16.2888888888889, 16.7107142857143, 
            9.82, 8.96543209876543, 19.6655555555556, 12.1266666666667, 16.5226666666667, 18.2555555555556, 6.68253968253968, 
            19.2689655172414, 7.93111111111111, 10.9411111111111, 17.3088888888889, 18.4588888888889, 20.0141025641026, 13.24, 
            9.6702380952381, 18.0724137931034, 19.6716666666667, 15.9952380952381, 13.4494252873563, 5.53194444444444, 16.9011111111111, 
            10.8463768115942, 14.508, 18.1694444444444, 18.0712121212121, 18.712962962963, 16.8540229885057, 21.4565217391304, 
            17.0761904761905, 20.7777777777778, 21.2253968253968, 19.8822222222222, 19.3625, 17.8382716049383, 19.7172413793103, 
            17.9388888888889, 20.0571428571429, 20.6358974358974, 19.1535714285714, 21.269696969697, 18.0909090909091, 17.8928571428571, 
            16.9487179487179, 16.1615384615385, 16.5814814814815, 16.9555555555556, 14.7822222222222, 16.967816091954, 16.3988888888889, 
            17.8908045977011, 16.4486111111111, 17.1011904761905, 15.6679487179487, 14.8753086419753, 17.3906666666667, 17.2773333333333, 
            19.1133333333333, 14.964, 11.7222222222222, 16.46, 16.0946666666667, 13, 15.4068965517241, 20.1037037037037, 
            20.2060606060606, 17.8758620689655, 14.4464285714286, 18.816049382716, 17.5555555555556, 15.7782051282051, 11.2677777777778, 
            20.8072463768116, 14.9269841269841, 20.2766666666667, 20.8511111111111, 20.7877777777778, 20.8855555555556, 15.8072463768116, 
            20.8349206349206, 16.7611111111111, 16.5388888888889, 14.1440476190476, 21.3366666666667, 13.5977777777778, 19.548275862069, 
            17.3869047619048, 14.2333333333333, 14.3595238095238, 13.6666666666667, 15.1702380952381, 9.57962962962963, 12.7122222222222, 
            12.6313725490196, 11.1309523809524, 12.4980392156863, 10.5188888888889, 10.0074074074074, 14.6283333333333, 14.7233333333333, 
            11.3855555555556), smoothness = 1)
    Distance <- "rdist"
    fields:::Krig(x = info$x, Y = info$y, Z = c(1580, 1398, 2298, 2590, 2724, 2413, 2358, 3448, 2361, 1113, 1672, 1488, 1519, 
        1632, 2434, 1272, 1586, 3056, 1625, 1894, 1885, 2339, 2097, 1721, 1295, 2208, 3445, 2438, 1823, 1763, 1881, 1885, 
        2705, 1552, 2402, 1562, 1615, 2763, 1805, 2012, 1284, 1982, 2071, 2364, 2135, 1446, 1525, 2321, 1495, 1320, 1366, 
        1800, 1479, 1409, 2556, 2556, 1552, 2650, 2475, 1418, 2367, 2329, 1943, 2743, 1033, 1137, 2318, 1958, 1162, 1058, 
        1677, 1601, 1305, 2233, 1279, 2711, 2593, 1718, 1106, 1186, 3103, 1695, 1871, 1510, 2344, 2377, 1806, 1937, 2379, 
        2123, 2339, 2512, 1976, 2684, 2139, 2355, 2169, 1440, 1733, 1922, 2804, 1415, 1610, 2550, 2690, 1616, 1271, 1833, 
        2758, 2071, 2345, 2182, 1216, 2873, 2532, 1396, 2085, 1202, 1342, 3049, 1525, 2809, 2643, 1838, 1753, 1531, 2332, 
        2471, 1897, 1214, 1586, 2396, 3243, 1077, 2405, 2092, 1260, 881, 1040, 967, 1104, 1115, 946, 997, 914, 1007, 1028, 
        903, 1025, 1049, 994, 1101, 930, 1010, 903, 1025, 1302, 939, 999, 1451, 1007, 1168, 976, 982, 1034, 1247, 1262, 811, 
        939, 1720, 2336, 2393, 2019, 2065, 2516, 2074, 1617, 1577, 1827, 2257, 1845, 1760, 2114, 2644, 1510, 2278, 1263, 
        1009, 913, 1326, 1673, 1373, 1841, 1665, 2068, 1257, 1911, 1647, 1446, 2156, 1629, 1833, 1644, 2461, 1868, 1940, 
        2254, 1915, 2215, 2175, 1540, 1579, 2070), m = m, nstep.cv = 80, method = "REML", give.warnings = FALSE, Covariance = "Matern", 
        smoothness = info$smoothness, theta = exp(ltheta), Distance = Distance)
}




