library(boot)

function_to_run <- function() {
    boot <- boot::boot
    city <- boot::city
    ratio <- genthat::with_env(function(d, w) sum(d$x * w)/sum(d$u * w), env = list2env(list(), parent = baseenv()))
    city.boot <- structure(list(t0 = 1.5203125, t = structure(c(1.23209428830462, 1.74603174603175, 1.27134502923977, 1.6502808988764, 
        1.98384201077199, 1.78963414634146, 1.58203799654577, 1.6614730878187, 1.44894366197183, 1.50833333333333, 1.6742671009772, 
        1.58664546899841, 1.55644355644356, 1.38025210084034, 1.6031746031746, 1.48613376835237, 1.49699879951981, 1.58781362007168, 
        1.78973509933775, 1.77804295942721, 1.53107344632768, 1.5741935483871, 1.70605187319885, 1.49493487698987, 1.48988439306358, 
        1.3876404494382, 1.64059900166389, 1.38154897494305, 1.5089928057554, 1.3046511627907, 1.64545454545455, 1.6171875, 
        1.46341463414634, 1.85924369747899, 1.42537313432836, 1.53017944535073, 1.31688311688312, 1.73644859813084, 1.27565084226646, 
        2.21079691516709, 1.42992874109264, 1.5997191011236, 1.29197080291971, 1.37981651376147, 1.67278287461774, 1.49338374291115, 
        1.48730964467005, 1.52075471698113, 1.4572192513369, 1.74446337308348, 1.44413012729844, 1.5796766743649, 1.53484320557491, 
        1.49576988155668, 1.42739273927393, 1.8895966029724, 1.6940133037694, 1.52276867030965, 1.25578406169666, 1.60329531051965, 
        1.96818181818182, 1.75984251968504, 1.67362924281984, 1.39698492462312, 1.24764468371467, 1.33019976498237, 1.702, 
        1.92229038854806, 1.52133333333333, 2.1993670886076, 1.37966101694915, 1.90032154340836, 1.49421487603306, 1.5278276481149, 
        1.52283464566929, 1.47210300429185, 1.60119047619048, 1.55070202808112, 1.54932301740812, 2.08247422680412, 1.53527607361963, 
        1.71052631578947, 1.40625, 2.925, 1.51911468812877, 1.62980769230769, 1.5448275862069, 1.49444444444444, 1.55526315789474, 
        1.51028037383178, 2.87735849056604, 1.41711956521739, 1.31847968545216, 1.47263017356475, 1.55826558265583, 1.35272277227723, 
        1.77324632952692, 1.88184931506849, 2.06199460916442, 1.86479591836735, 1.41191066997519, 1.71362048894063, 2.1045197740113, 
        1.43432835820896, 1.64300626304802, 1.43983957219251, 1.48019801980198, 1.52615844544096, 1.7318339100346, 1.64615384615385, 
        1.4780292942743, 1.72574626865672, 1.52328767123288, 1.4156976744186, 1.47155963302752, 2.18518518518519, 1.53644314868805, 
        1.49300699300699, 1.37570093457944, 1.44025974025974, 1.50990752972259, 1.39429312581064, 1.43110504774898, 1.51841359773371, 
        1.26315789473684, 1.93922651933702, 1.58080808080808, 1.36191860465116, 1.35561497326203, 1.41176470588235, 1.32508833922261, 
        1.48293172690763, 1.85945945945946, 1.71172413793103, 1.54627249357326, 1.5, 1.55576923076923, 1.3922942206655, 1.59770114942529, 
        2.05846153846154, 1.54477611940299, 1.44934445768772, 2.32075471698113, 1.49521203830369, 1.37122302158273, 1.58503401360544, 
        1.5678496868476, 1.70588235294118, 1.35882352941176, 1.70598591549296, 1.38996138996139, 1.54879773691655, 1.34333333333333, 
        1.71548821548822, 2, 1.46478873239437, 1.240058910162, 1.87074829931973, 1.56597774244833, 1.65196850393701, 1.64142194744977, 
        1.649468892261, 1.65498652291105, 1.52882483370288, 1.48860398860399, 1.25944333996024, 1.32275132275132, 1.63881019830028, 
        1.25111111111111, 1.20742358078603, 1.48581560283688, 1.38084632516704, 1.40789473684211, 1.47398843930636, 2.25435540069686, 
        2.1407249466951, 1.47431506849315, 1.44848484848485, 1.64353312302839, 1.59680284191829, 1.20322180916976, 1.38837209302326, 
        1.33189033189033, 1.37019230769231, 1.49427480916031, 1.49446494464945, 1.48004561003421, 1.44215349369989, 1.38769804287046, 
        1.33768352365416, 1.79047619047619, 1.64253393665158, 1.40087463556851, 1.23147092360319, 2.07547169811321, 1.44777911164466, 
        1.56687898089172, 1.43398392652124, 1.46231155778894, 1.50721649484536, 1.66334661354582, 1.50239808153477, 1.30588235294118, 
        2.05050505050505, 1.42571428571429, 1.88758782201405, 1.2612293144208, 1.43528064146621, 1.43390804597701, 1.70136518771331, 
        1.31578947368421, 1.78672985781991, 1.49466192170818, 1.41202346041056, 1.73640167364017, 1.2775, 2.48214285714286, 
        1.75578406169666, 1.57566765578635, 1.52821128451381, 1.64644970414201, 1.83371298405467, 1.50928792569659, 1.42153846153846, 
        1.76939203354298, 1.36896551724138, 1.3120728929385, 1.36020583190394, 2.25, 1.54558823529412, 1.56235011990408, 
        1.51960784313725, 1.6085409252669, 1.88125, 1.58278145695364, 1.51014040561622, 1.47661469933185, 1.44400785854617, 
        1.47519083969466, 1.46571798188875, 1.76, 1.51309707241911, 1.66909090909091, 1.39969604863222, 1.22502870264064, 
        1.50109409190372, 1.36707152496626, 1.54244306418219, 2.23926380368098, 1.57486631016043, 1.55259259259259, 1.42147117296223, 
        1.60901162790698, 1.44347826086957, 1.291015625, 1.39458413926499, 1.83082077051926, 1.58795562599049, 1.67692307692308, 
        1.49148418491484, 1.94763092269327, 1.34154929577465, 1.50990990990991, 1.58576874205845, 2.27173913043478, 1.55395683453237, 
        1.44977511244378, 1.54579439252336, 1.66770186335404, 1.32865168539326, 1.4310595065312, 1.47098976109215, 1.14174107142857, 
        1.38115942028985, 1.47058823529412, 1.45514223194748, 1.93170731707317, 1.75127768313458, 1.41044776119403, 1.6089552238806, 
        1.74730021598272, 1.4960362400906, 1.3462389380531, 1.83269961977186, 1.53595890410959, 1.39877924720244, 1.73258003766478, 
        1.76219512195122, 1.48382126348228, 1.94274028629857, 1.62684729064039, 1.48809523809524, 1.34547908232119, 1.41687979539642, 
        1.57984790874525, 1.59692898272553, 1.46234676007005, 1.45392491467577, 1.30120481927711, 1.22691705790297, 1.53007518796992, 
        1.70196078431373, 1.78532110091743, 1.82364729458918, 1.29985228951256, 1.4532967032967, 1.54673721340388, 1.43377001455604, 
        1.3443072702332, 1.2308533916849, 1.69067103109656, 1.41379310344828, 1.83905013192612, 1.63102725366876, 1.27225130890052, 
        1.62243285939968, 1.62158469945355, 1.41147378832839, 1.27913669064748, 1.51124437781109, 1.51650165016502, 1.75609756097561, 
        1.57242582897033, 1.45015105740181, 1.47661469933185, 1.54780361757106, 1.45155709342561, 1.51752577319588, 1.32913165266106, 
        1.70993914807302, 1.336578581363, 1.29116684841876, 1.28389830508475, 1.76315789473684, 1.5217965653897, 1.77896995708155, 
        1.44224422442244, 1.43946188340807, 1.30807248764415, 1.66845637583893, 1.57062146892655, 1.39866666666667, 1.29307282415631, 
        1.35900962861073, 1.44374209860936, 1.41578327444052, 1.57860615883306, 1.53859649122807, 1.90978886756238, 1.5017667844523, 
        1.53168469860896, 1.36061684460261, 1.59667673716012, 1.92792792792793, 1.6502311248074, 1.71653543307087, 1.4051724137931, 
        1.35175202156334, 1.82640144665461, 2.25233644859813, 1.64421052631579, 1.86240786240786, 1.44388398486759, 1.65102040816327, 
        1.53688524590164, 1.5939524838013, 1.73291925465838, 1.83695652173913, 1.56585365853659, 1.76036036036036, 1.71146953405018, 
        1.27291666666667, 1.4582651391162, 1.24807395993837, 1.4131455399061, 1.5557461406518, 1.52844036697248, 2.4, 1.37990762124711, 
        1.46234676007005, 1.6189376443418, 1.72386587771203, 1.62912912912913, 1.61896243291592, 2.44915254237288, 1.45497630331754, 
        1.39461358313817, 1.80971659919028, 1.19035846724351, 1.51901840490798, 1.34248554913295, 1.70112781954887, 1.47713226205192, 
        1.50606585788562, 1.58461538461538, 1.46488764044944, 1.27931488801054, 1.25784447476126, 1.58675078864353, 1.48435689455388, 
        1.4384133611691, 1.80769230769231, 1.5295358649789, 1.30880713489409, 1.62272727272727, 1.57213930348259, 1.61422413793103, 
        1.40702087286528, 2.15723270440252, 1.44374009508716, 1.496336996337, 1.26643192488263, 1.7549504950495, 1.64755838641189, 
        1.23748773307164, 1.63833992094862, 1.38340336134454, 1.49699879951981, 1.4141592920354, 1.60670731707317, 1.57824639289678, 
        1.53242320819113, 1.67478510028653, 1.44394110985277, 1.66094986807388, 1.39643347050754, 1.50375939849624, 1.6568144499179, 
        1.42657342657343, 2.01025641025641, 2.03243243243243, 1.46418338108882, 2.26451612903226, 1.59010600706714, 1.4803664921466, 
        1.37926136363636, 1.70429252782194, 1.30973451327434, 1.50909090909091, 1.35633802816901, 1.56666666666667, 1.57404326123128, 
        2.11407766990291, 1.82281059063136, 1.88235294117647, 1.63177570093458, 1.30830670926518, 1.51192660550459, 1.45711592836946, 
        1.44011976047904, 1.45679012345679, 1.78963414634146, 1.36054421768707, 1.47261345852895, 1.98260869565217, 1.93355481727575, 
        1.53214285714286, 1.40944123314066, 1.66735537190083, 1.51803751803752, 1.50208333333333, 1.83854166666667, 2.04319654427646, 
        1.47538461538462, 1.95559502664298, 1.16988416988417, 1.57818181818182, 1.3135593220339, 1.31806615776081, 2.11049723756906, 
        1.43275632490013, 1.42105263157895, 1.33489827856025, 1.27962577962578, 1.55228758169935, 1.75136612021858, 1.6913123844732, 
        1.46049896049896, 1.68047337278107, 1.32616487455197, 1.83379501385042, 1.38356164383562, 1.52981969486824, 1.54303599374022, 
        1.74432677760968, 1.22960725075529, 1.42857142857143, 1.42021924482339, 1.65365853658537, 1.85342789598109, 1.54050073637703, 
        1.29956896551724, 1.84602917341977, 1.8459595959596, 1.46143437077131, 1.46498599439776, 2.19770114942529, 1.26954492415403, 
        1.40937896070976), .Dim = c(499L, 1L)), R = 499, data = structure(list(u = c(138, 93, 61, 179, 48, 37, 29, 23, 30, 
        2), x = c(143, 104, 69, 260, 75, 63, 50, 48, 111, 50)), row.names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", 
        "10"), class = "data.frame"), seed = c(10403L, 624L, 507561766L, 1260545903L, 1362917092L, -1772566379L, -1344458670L, 
        1072028587L, -1293707536L, 1708789297L, -1333339586L, 256895399L, 998413756L, -555191411L, -1047547670L, -50950813L, 
        -1543487672L, -1766763351L, 32923734L, 1971684063L, 1718493076L, -1117926011L, 890393730L, -1032174053L, 932479648L, 
        -1892763103L, -1040205458L, 262148887L, -1220643732L, 1566094973L, -137659622L, 1045161427L, -1555709704L, 178265753L, 
        -1033943674L, -1034388913L, -1721830332L, -1749741963L, -1137867598L, -2065544053L, 866474576L, 458187281L, 1218274462L, 
        -2000447353L, 199687964L, 1107998061L, 590795082L, -858760637L, -240079192L, 839017609L, -1886488906L, -1479389761L, 
        1595536628L, 1848478565L, 368165090L, -1706758405L, -128901632L, 360384001L, 2027084750L, 1372682743L, -1578682932L, 
        -1716686755L, 1324659578L, 1519053491L, 2044463192L, -906549639L, 1851192294L, -1175847633L, -1083563612L, -849984427L, 
        333580562L, 1871261035L, 1972555184L, 1756407281L, 1943215870L, -1751074969L, 1282021500L, -1397758131L, 518529450L, 
        -1421699293L, 488820232L, -413309847L, 1749794070L, 441878687L, 81427028L, 1971206469L, -1203675838L, 995493851L, 
        -366646944L, -810597919L, 2006003246L, 1288196311L, -111499476L, -280946115L, -4973606L, 75390867L, 1671430072L, 
        -422306215L, -1145056698L, -393285617L, 1823866628L, 1253337653L, 1712504178L, 1846705739L, -1820069616L, -990520879L, 
        247466334L, -1717615033L, 1633935836L, -246413011L, 1455137290L, -1652210685L, 741252456L, 1555715145L, 197538678L, 
        -1312148609L, -687362124L, 1153947429L, 286861730L, 568692923L, 1575576768L, 1925410241L, 1087549582L, 1279039415L, 
        -1208956788L, 1317778461L, -1306414022L, 257836147L, 1550427928L, 86967865L, -1875779418L, -520138001L, 1989839972L, 
        1598521365L, 1842848210L, -1967767765L, -1806646160L, -1558774351L, -1040440386L, 1215776039L, 1529633596L, -1637672179L, 
        -121023894L, -992976669L, -1867768632L, -1273940951L, 1167448534L, 786779743L, -2131127020L, -1987943163L, 563160578L, 
        1714129307L, -1871376352L, -1347450463L, 590308078L, -135901545L, -2080269844L, 1678065149L, -1705673574L, 1784846675L, 
        -871301512L, 1157619225L, 491069190L, 301147599L, -563099196L, -1769503243L, -230115790L, 1806462987L, 1792100304L, 
        1913393553L, 35614238L, -1176456185L, -165968740L, -27190035L, -1087819062L, 1583082947L, 678644776L, -1957034999L, 
        760393782L, 778033471L, -636999052L, 757457637L, -155102622L, -1134562693L, -1432327296L, 862688641L, 960447822L, 
        1400730999L, -1343939764L, -1742358563L, 2020046074L, 549674547L, -2039609896L, 1111401977L, -527331994L, -970823505L, 
        -779241692L, -1209238571L, -964822382L, 1395462379L, -170034384L, -1664281231L, 264366206L, 1603506919L, -1702273540L, 
        398593741L, -269270230L, -1017124189L, 1029450632L, -57883671L, 647280278L, 686937119L, -443846700L, 1428836549L, 
        -1446924606L, 1958398811L, -1052543264L, -1494249119L, 1771722670L, -1095103401L, 972246188L, 258286013L, -1737515686L, 
        1505268499L, -883376840L, 350445017L, -1548801082L, 608508815L, -1454615420L, -957455947L, -913346830L, 527442379L, 
        5070480L, -1974335151L, -142896418L, 122151367L, 1556997980L, -1392643923L, 1564443530L, 1762940803L, -2059486488L, 
        -1650363447L, -520885002L, 1934835455L, -757373644L, 1661447845L, 1604991778L, 2071204923L, -717868480L, -1355580095L, 
        1725471246L, -179039433L, -863752692L, -1438942307L, -762972742L, 1484404723L, 1185490072L, 1357252025L, 2083912230L, 
        789790319L, -352083484L, 50673557L, -426437806L, 1252893355L, 1090056688L, -1651315407L, -1847300802L, -625631065L, 
        -46063428L, 1015857805L, 1696986090L, -525257629L, 569571912L, -2138041431L, 1476940630L, 1044126175L, -45086060L, 
        -197788539L, 1234368386L, 1489227035L, -749691488L, -315664095L, -1349383058L, 251890199L, -1108361364L, 86033789L, 
        -1966965222L, 2084588755L, 272055288L, 104766873L, -876742522L, -985345713L, 1208721220L, -408355467L, 346482610L, 
        -350383221L, 1522021712L, 898089233L, -2087422050L, 1603587975L, -398783972L, 15107181L, -239168438L, -680623805L, 
        -1588532824L, 860922761L, -748033610L, -1771805505L, -331259916L, -500352411L, -1533811742L, 820114939L, -1804945152L, 
        -35969791L, -1906397490L, 2139123959L, 277741772L, 2022506333L, -1321388422L, 1078120883L, -1411710120L, -1058724487L, 
        1071589094L, -1584278481L, -1648603996L, 743551829L, 1457318930L, -1292372885L, -597481296L, -1389853455L, 1025749502L, 
        2006806119L, 907256700L, -259836339L, 2032231594L, 377765411L, -47150840L, -1076157591L, -424628202L, 1686380447L, 
        1392993620L, 1113942085L, -1178271678L, -1006203173L, -581139360L, 2049892577L, 433488174L, 377669591L, 1924592172L, 
        418916669L, -1039261990L, 1002030739L, 158104248L, -1999528615L, -768506554L, 1521633039L, -177362428L, -998811339L, 
        -1135665038L, -260782773L, 1087491088L, 1533884625L, -81126306L, 1619492167L, -1423774500L, -1109731283L, -43621110L, 
        -2094372093L, -1687562136L, -1406692535L, 1903470198L, 1834175103L, 284826292L, 1716946469L, -566342494L, 1852413883L, 
        1593704384L, -148730687L, 881951630L, -4026697L, 1052939148L, -1227209955L, -984795334L, 568142707L, -2067553768L, 
        -503577287L, -934472794L, 1667115503L, -2072529052L, -544084203L, 1612022994L, -1916008917L, -287563920L, -1823613775L, 
        -968902978L, -1274348505L, -1212094916L, -681219571L, 212178282L, 513345507L, 1305794504L, -97651927L, -1622291242L, 
        1367991647L, 829521940L, -612854779L, 1930938626L, 675483803L, -1238947040L, 95299745L, -1926777362L, -1023949417L, 
        2064180460L, -559198979L, 1326612378L, -1041956781L, -440895112L, -866362087L, -1278619130L, 172850383L, -1405979452L, 
        -384207627L, 1766332722L, 288732939L, 962208464L, -1547538287L, 1929150750L, 1742727943L, 2017824668L, 1738206189L, 
        -1057557046L, 101192899L, 1380550440L, 669401865L, -405527754L, -1914703809L, -339372684L, 1799590373L, -446073502L, 
        -2050295429L, 1806698112L, 852079745L, -1640949682L, 1138388087L, -639506868L, -656193827L, 2138437626L, 118048051L, 
        1612906712L, -1008032519L, 1916780646L, 2050506671L, -101326300L, -2004489515L, 184475026L, -1662396437L, 1596184112L, 
        -675089295L, -1577550978L, -843167257L, -1257707268L, 1425235405L, -1066236374L, 1924108707L, 1386210952L, 793281257L, 
        245344662L, 2064476959L, -1555146028L, 456097733L, -1370795582L, -1220980133L, -193949216L, 124596321L, -1371166034L, 
        -1037925545L, -1180330068L, -1443221315L, 42967130L, -125699565L, -1814349768L, -1063330599L, 759619270L, -1177128305L, 
        656015236L, -1588637515L, -2075012622L, -283088693L, -1961805424L, 1984391249L, -1077172770L, -1822549817L, -496831908L, 
        1105641389L, 1026573962L, -1178108285L, 1689253352L, -2041793847L, 591945718L, 1305105919L, -412889036L, 750017957L, 
        1389714978L, -2000282821L, -1321153216L, 143694913L, -805475058L, -645395913L, 615250188L, 308808349L, 276265146L, 
        -1182327053L, -1934024808L, 913376441L, 1517759782L, -1411377809L, 418827492L, 1391306389L, 542701138L, 1645308331L, 
        -738571024L, -1035482063L, 84803646L, -1032366169L, 548121532L, -1930620531L, -179816726L, 1283971939L, 173126984L, 
        518705833L, -2124003754L, 382644447L, 1935537556L, 491400069L, 1679792770L, 1655264283L, -285689696L, -1221855199L, 
        -504340626L, -2117926633L, -783480212L, -1901800323L, 1833271578L, -1991199789L, -1030441224L, 358161561L, -1150768250L, 
        252520527L, -521909692L, -120001419L, 908872370L, -336274805L, 1018630224L, -88334319L, 1985448606L, -1061026169L, 
        1010504988L, 1350456173L, 852645706L, -1205295037L, 828187816L, 1729815177L, -795779914L, -1026393153L, 781503220L, 
        -1503073947L, 2135033570L, 1226505467L, -428846080L, -1875426303L, -1900641842L, 244017143L, 568380364L, 1462275677L, 
        1762769274L, -1021921101L, 424017496L, -917560199L, 1572035046L, 2115349295L, -1137018972L, 713630293L, 686018322L, 
        520272747L, -1273003088L, 1520198641L, -465550082L, 1341531495L, -1385615748L, 1662158157L, -874076246L, -1511922397L, 
        866796552L, 1221911145L, 73507606L, 445494943L, 744509524L, -1115121851L, 1297392450L, -598534693L, -1132486816L, 
        212500449L, 1290261550L, 798572247L, 616512812L, 1617639485L, -537648678L, -569299565L, -526060104L, 978000985L, 
        -1695598522L, 1873911311L, 340874500L, -1149876171L, 1737982834L, 695405643L, 353085200L, 417372113L, -346017954L, 
        -1916029881L, -1735526436L, 1461823277L, 580724746L, -622095869L, -686746776L, 705745481L), statistic = genthat::with_env(function(d, 
        w) sum(d$x * w)/sum(d$u * w), env = list2env(list(), parent = baseenv())), sim = "ordinary", call = boot(data = city, 
        statistic = ratio, R = 499, stype = "w"), stype = "w", strata = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1), weights = c(0.1, 
        0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1)), class = "boot", boot_type = "boot")
    boot:::linear.approx(boot.out = city.boot)
}




