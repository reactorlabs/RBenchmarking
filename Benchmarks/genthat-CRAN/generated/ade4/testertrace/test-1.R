library(ade4)

function_to_run <- function() {
    Y.cw <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
    Y <- structure(list(Eda = c(2.19500461821589, -0.59713140685704, -0.59713140685704, -0.59713140685704, -0.0776957747196058, 
        -0.325914622925159), Bsp = c(0.101942676830774, -1.97405453890375, -0.303110656774293, 0.308939256025807, 0.646881063600245, 
        1.21940219922122), Brh = c(0.0182105239901265, -1.54138053280898, -1.08076074780214, 0.865284402239756, 0.556586893444471, 
        1.18205946093676), Bni = c(1.51594161197592, -0.853605029469735, -0.853605029469735, -0.853605029469735, -0.174024351577639, 
        1.21889782801092), Bpu = c(1.60821986496043, -0.899098235890232, -0.899098235890232, -0.899098235890232, 0.099872409187728, 
        0.989202433522536), Cen = c(1.72117226021342, -0.743994804094533, -1.26071100506608, 0.822473173929485, -0.460461255147337, 
        -0.0784783698349514), Ecd = c(-0.689123198533342, -0.689123198533342, -0.689123198533342, -0.586705458199109, 1.92245635488935, 
        0.731618698909784), Rhi = c(0.572479196410648, -0.89660995840502, -1.05766127429152, -0.0243662078644869, -0.471756305792957, 
        1.87791454994334), Hla = c(1.81416728615076, -1.15854464700528, -0.903466267616667, 0.106955610687867, -0.443830160496383, 
        0.584718178279707), Hab = c(-0.575572408503663, -0.575572408503663, -0.575572408503663, 0.145014400303928, 2.15727523371072, 
        -0.575572408503663), Par = c(1.74712048975948, -1.12080184323885, -0.646231850249736, -0.0162800989242891, 0.815855261113618, 
        -0.779661958460219), Cae = c(-0.63515157680679, -0.63515157680679, -0.63515157680679, 2.03154874268395, 0.509057564543213, 
        -0.63515157680679), Eig = c(-0.740318384153224, -0.985598891140531, -0.985598891140531, 0.130305489380904, 1.00704358033292, 
        1.57416709672046)), class = "data.frame", row.names = c("S1", "S2", "S3", "S4", "S5", "S6"))
    X.cw <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
    X <- structure(list(Temp = c(-1.8058217691252, -0.415251423043163, 0.0851819845494077, 1.48714977808508, 0.586354339891739, 
        0.0623870896421367), Flow = c(-1.59351177790685, -0.698525501696839, -0.290265753219502, 0.593060275889507, 0.466291810008611, 
        1.52295094692508), pH = c(0.331722279134339, -1.74719468720278, -0.798207926789473, 0.168053079029908, 1.22231035455643, 
        0.82331690127158), Cond = c(-0.340772995444264, 1.49977860661117, 0.761065598851227, 0.0953874652246786, -0.295275322738742, 
        -1.72018335250407), Oxyg = c(0.557333780104351, -2.15870551857162, -0.120277944611293, 0.683409231084856, 0.58576466489868, 
        0.452475787095024), Bdo5 = c(-0.828567360622104, 2.06720415604884, 0.289825989752595, -0.204384669810775, -0.79947900954947, 
        -0.524599105819087), Oxyd = c(-0.632389786656445, 2.15115341847606, 0.0272070568879133, -0.2265984266588, -0.501313983740125, 
        -0.818058278308603), Ammo = c(-0.816859573475212, 1.96827998718347, 0.530447513093347, -0.166156372835877, -0.736163987275002, 
        -0.779547566690723), Nitr = c(-0.694038298596893, -1.28463608575942, 1.04233163721238, 0.947274150964036, 0.965146903724197, 
        -0.976078307544301), Phos = c(-1.22058681315502, 1.50710966990934, 1.01586184017946, 0.100664523962454, -0.375636522623697, 
        -1.02741269827253)), class = "data.frame", row.names = c("S1", "S2", "S3", "S4", "S5", "S6"))
    nrepet <- 999
    ade4:::testertrace(npermut = nrepet, pc1 = X.cw, pc2 = Y.cw, tab1 = X, tab2 = Y, l1 = nrow(X), c1 = ncol(X), c2 = ncol(Y))
}




