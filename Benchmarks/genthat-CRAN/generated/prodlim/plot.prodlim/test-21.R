library(prodlim)

function_to_run <- function() {
    cdat <- structure(list(eventtime = c(4.20759499111768, 5.43372275632054, 8.18108800817028, 2.58517892604418, 4.46235326518934,
        2.58143830570872, 16.9863210337899, 0.595491010255675, 16.0572034225101, 1.29455067952448, 9.19060078457263, 5.89288743599613,
        12.8259515490312, 2.80143736152228, 0.750618904075463, 1.2627816917473, 1.8949948933335, 16.8182780399343, 16.4201579065544,
        7.2501236748846), censtime = c(3.69882683846148, 11.5678971454676, 6.40601502930119, 3.58102187551108, 3.04397633011161,
        9.69944478873183, 3.80593717359634, 8.15063967652128, 5.47253329130713, 2.01511277928591, 7.50085241757985, 10.805750581573,
        5.4465893651155, 8.93004593888821, 8.64162155332517, 8.63521575496091, 5.47861358790415, 14.9436554156758, 6.65496379630547,
        9.2860865421708), time = c(3.69882683846148, 5.43372275632054, 6.40601502930119, 2.58517892604418, 3.04397633011161,
        2.58143830570872, 3.80593717359634, 0.595491010255675, 5.47253329130713, 1.29455067952448, 7.50085241757985, 5.89288743599613,
        5.4465893651155, 2.80143736152228, 0.750618904075463, 1.2627816917473, 1.8949948933335, 14.9436554156758, 6.65496379630547,
        7.2501236748846), event = c(0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1), X1 = c(1, 1, 1, 1, 1, 1,
        0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0), X2 = c(-0.771408001996856, -0.507342353723463, -0.270022583786385, 0.74811656342622,
        0.668593810460555, -0.455298660081533, -1.92784522429471, 1.88197706699389, -1.24971112993433, -0.489344968902409,
        0.215391285188049, 0.422108673603984, -1.22114827886872, 0.31222782062225, 0.886462134092602, 0.474810692727149,
        0.869841354736154, -0.886523795971777, -0.128655531460981, 1.09651049495896), status = c(0, 1, 0, 1, 0, 1, 0, 1,
        0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1), patnr = c(2L, 2L, 2L, 3L, 1L, 2L, 5L, 4L, 2L, 1L, 4L, 4L, 1L, 5L, 5L, 5L, 2L,
        5L, 3L, 1L)), class = "data.frame", row.names = c(NA, -20L))
    prodlim <- prodlim::prodlim
    kmfitC2 <- structure(list(time = c(3.80593717359634, 5.4465893651155, 6.65496379630547, 7.2501236748846, 7.50085241757985,
        14.9436554156758, 0.595491010255675, 0.750618904075463, 1.2627816917473, 1.29455067952448, 1.8949948933335, 2.58143830570872,
        2.58517892604418, 2.80143736152228, 3.04397633011161, 3.69882683846148, 5.43372275632054, 5.47253329130713, 5.89288743599613,
        6.40601502930119), n.risk = structure(c(6, 5, 4, 3, 2, 1, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 4, 4, 4,
        3, 2, 1, 5, 5, 5, 5, 5, 5, 5, 4, 3, 2, 2, 2, 2, 1), .Dim = c(20L, 2L), .Dimnames = list(NULL, c("n.risk", "cluster.n.risk"))),
        n.event = structure(c(0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1,
            1, 1, 1, 0, 0, 1, 0, 1, 0), .Dim = c(20L, 2L), .Dimnames = list(NULL, c("n.event", "cluster.n.event"))), n.lost = structure(c(1,
            1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
            0, 0), .Dim = c(20L, 2L), .Dimnames = list(NULL, c("n.lost", "cluster.n.lost"))), surv = c(1, 1, 1, 0.666666666666667,
            0.666666666666667, 0.666666666666667, 0.928571428571429, 0.857142857142857, 0.785714285714286, 0.714285714285714,
            0.642857142857143, 0.571428571428571, 0.5, 0.428571428571429, 0.428571428571429, 0.428571428571429, 0.321428571428571,
            0.321428571428571, 0.160714285714286, 0.160714285714286), se.surv = c(0, 0, 0, 0.181443684650606, 0.181443684650606,
            0.181443684650606, 0.0659872622461347, 0.085548760345077, 0.132430740482009, 0.142094140650788, 0.103332152296987,
            0.0685603669819636, 0.0794152871344019, 0.125199757409319, 0.125199757409319, 0.125199757409319, 0.0843860399873504,
            0.0843860399873504, 0.0767977826869821, 0.0767977826869821), naive.se.surv = c(0, 0, 0, 0.272165526975909, 0.272165526975909,
            0.272165526975909, 0.0688302936899594, 0.0935219529582824, 0.109664210511248, 0.120736322104074, 0.128060208142971,
            0.132260014253222, 0.133630620956212, 0.132260014253222, 0.132260014253222, 0.132260014253222, 0.135828362367083,
            0.135828362367083, 0.132389111418415, 0.132389111418415), hazard = c(0, 0, 0, 0.333333333333333, 0, 0, 0.0714285714285714,
            0.0769230769230769, 0.0833333333333333, 0.0909090909090909, 0.1, 0.111111111111111, 0.125, 0.142857142857143,
            0, 0, 0.25, 0, 0.5, 0), first.strata = c(1L, 7L), size.strata = c(6L, 14L), model = "survival", maxtime = 14.9436554156758,
        lower = c(0, 0, 0, 0.311043579529236, 0.311043579529236, 0.311043579529236, 0.799238771130605, 0.689470367944458,
            0.526154803923579, 0.435786316196001, 0.440329845910041, 0.437052721377074, 0.344348897394665, 0.183184413176011,
            0.183184413176011, 0.183184413176011, 0.156034972255408, 0.156034972255408, 0.0101933975552671, 0.0101933975552671),
        upper = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 0.992785112375428, 0.845384439804245, 0.705804421480069, 0.655651102605335,
            0.673958443966846, 0.673958443966846, 0.673958443966846, 0.486822170601735, 0.486822170601735, 0.311235173873304,
            0.311235173873304), call = prodlim(formula = Hist(time, status) ~ X1 + cluster(patnr), data = cdat), formula = Hist(time,
            status) ~ X1 + cluster(patnr), model.response = structure(c(0.595491010255675, 0.750618904075463, 1.2627816917473,
            1.29455067952448, 1.8949948933335, 2.58143830570872, 2.58517892604418, 2.80143736152228, 3.04397633011161, 3.69882683846148,
            3.80593717359634, 5.43372275632054, 5.4465893651155, 5.47253329130713, 5.89288743599613, 6.40601502930119, 6.65496379630547,
            7.2501236748846, 7.50085241757985, 14.9436554156758, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0,
            0), .Dim = c(20L, 2L), .Dimnames = list(c("8", "15", "16", "10", "17", "6", "4", "14", "5", "1", "7", "2", "13",
            "9", "12", "3", "19", "20", "11", "18"), c("time", "status")), class = "Hist", states = "1", model = "survival",
            cens.type = "rightCensored", cens.code = "0", entry.type = ""), originalDataOrder = c(10L, 12L, 16L, 7L, 9L,
            6L, 11L, 1L, 14L, 4L, 19L, 15L, 13L, 8L, 2L, 3L, 5L, 20L, 17L, 18L), X = structure(list(X1 = c(0, 1)), class = "data.frame",
            row.names = 1:2), model.matrix = structure(list(X1 = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0,
            0, 0)), row.names = c(8L, 15L, 16L, 10L, 17L, 6L, 4L, 14L, 5L, 1L, 7L, 2L, 13L, 9L, 12L, 3L, 19L, 20L, 11L, 18L),
            class = "data.frame"), discrete.predictors = "X1", continuous.predictors = NULL, xlevels = list(X1 = c(1, 0)),
        clustervar = "patnr", covariate.type = 2, cens.type = "rightCensored", conf.int = 0.95, reverse = FALSE, type = "surv",
        na.action = NULL), class = "prodlim")
    prodlim:::plot.prodlim(x = kmfitC2)
}




