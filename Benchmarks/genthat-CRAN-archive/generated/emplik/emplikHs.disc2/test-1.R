library(emplik)

function_to_run <- function() {
    fun2 <- genthat::with_env(function(x) {
        cbind(as.numeric(x <= 960), as.numeric(x <= 860))
    }, env = list2env(list(), parent = baseenv()))
    ymale <- c(782, 1020, 856, 915, 863, 906, 955, 943, 943, 837, 966, 936, 919, 852, 1073, 925, 967, 806, 969, 923, 865, 
        953, 871, 982, 883, 817, 875, 821, 936, 971, 830, 885, 894, 893, 866, 878, 820, 1007, 879, 956, 854, 890, 1041, 978, 
        836, 938, 886, 876, 955, 823, 960, 843, 856, 847, 1027, 988, 953, 978, 981, 926, 1036, 1016, 969, 900, 898, 846, 
        964, 984, 1046, 871, 847, 962, 853, 967, 1063, 856, 865, 1051, 1010, 878, 1021, 959, 921, 836, 919, 751, 906, 835, 
        946, 759, 909, 962, 984, 891, 835, 1039, 1010)
    yfemale <- c(1042, 921, 885, 901, 808, 915, 901, 852, 828, 968, 936, 977, 929, 936, 1016, 910, 1140, 1015, 850, 895, 
        854, 957, 1013, 1073, 976, 872, 1027, 1071, 919, 894, 885, 889, 887, 920, 1015, 942, 924, 883, 930, 956, 886, 987, 
        883, 837, 958, 850, 890, 847, 919, 748, 934, 895, 874, 877, 900, 957, 1013, 967, 904, 829, 842, 802, 840, 792, 837, 
        941, 746, 834, 865, 828, 894, 874, 917, 993, 918, 818, 984, 1002, 857, 827, 883, 1008, 954, 905, 838, 934, 872, 918, 
        844, 805, 922, 821, 838, 934, 886, 934, 878, 935, 799, 849, 920, 948, 968, 908, 828, 897, 823, 950, 1049, 878, 854, 
        877, 820, 899, 855, 827, 925, 900, 935, 1005, 855, 920, 810, 792, 882, 934, 910, 865, 899, 982, 856, 961, 893, 861, 
        829, 882, 875, 833, 972, 807, 924, 845, 840, 867, 881, 901, 944, 821, 811, 1007, 912, 802, 928, 911, 847, 1035, 893, 
        922, 977, 941, 869, 885, 859, 948, 890, 887, 968, 927, 997, 846, 831, 842, 768, 896, 894, 885, 822, 927, 897, 848, 
        912, 863, 813, 802, 956, 822, 934, 1026, 981, 934, 836, 760, 820, 907, 979, 894, 852, 948, 813, 902, 913, 810, 841, 
        875, 841, 948, 859, 820, 860, 917, 936, 950, 1013, 847, 777, 960, 920, 935, 933, 933, 797, 733, 866, 870, 795, 905, 
        796, 965, 775, 942, 895, 981, 991, 894, 886, 871, 839, 839, 858, 830, 868, 831, 783, 925, 898, 910, 958, 866, 851, 
        906, 882, 815, 972, 973, 957, 1010, 1070, 895, 818, 864, 857, 1028, 892, 769, 883, 972, 965, 925, 814, 805, 992, 
        943, 951, 926, 954, 944, 935, 900, 762, 823, 978, 966, 912, 823, 909, 967, 851, 843, 963, 888, 794, 905, 1039, 901, 
        823, 809, 887, 859, 1004, 919, 958, 1003, 871, 864, 996, 1034, 873, 984, 943, 1007, 935, 929, 939, 772, 871, 873, 
        981, 894, 994, 976, 847, 859, 933, 861, 886, 943, 931, 948, 955, 1004, 828, 835, 868, 988, 861, 959, 959, 871, 847, 
        874, 992, 1027, 857, 994, 1041, 900, 1096, 930, 943, 1024, 802, 811, 927, 967, 943, 840, 979, 921, 986, 1039, 968, 
        955, 837, 861, 967)
    xmale <- c(909, 1128, 969, 957, 983, 1012, 1055, 1025, 1043, 945, 1009, 971, 1033, 869, 1139, 1036, 1085, 943, 1001, 
        1060, 1002, 1031, 945, 1006, 959, 843, 1012, 956, 1073, 1107, 940, 911, 1031, 996, 895, 1015, 957, 1043, 1016, 1093, 
        989, 1027, 1044, 1005, 973, 1064, 1023, 1013, 977, 960, 1047, 943, 951, 984, 1058, 1045, 953, 1018, 1118, 970, 1070, 
        1153, 1106, 936, 906, 866, 1029, 1053, 1080, 872, 893, 966, 894, 985, 1094, 927, 948, 1059, 1012, 911, 1094, 972, 
        993, 876, 993, 777, 966, 907, 1031, 781, 914, 998, 1022, 932, 898, 1060, 1044)
    xfemale <- c(1172, 1040, 1003, 1018, 932, 1004, 1023, 908, 868, 990, 1033, 1056, 999, 1064, 1122, 1020, 1200, 1056, 940, 
        996, 969, 1089, 1115, 1192, 1085, 976, 1142, 1200, 1017, 1006, 1012, 1000, 1012, 1040, 1024, 1070, 1014, 996, 944, 
        1085, 994, 1097, 966, 948, 1029, 963, 905, 970, 1015, 804, 1041, 991, 982, 989, 959, 1084, 1131, 1068, 919, 848, 
        979, 876, 938, 929, 848, 1006, 804, 932, 932, 965, 1011, 1011, 1054, 1028, 1055, 955, 1019, 1010, 994, 836, 1020, 
        1042, 1091, 1042, 975, 946, 940, 922, 981, 928, 1059, 958, 975, 961, 1023, 1023, 1010, 1072, 825, 952, 953, 998, 
        1105, 996, 965, 1034, 938, 1008, 1186, 1015, 991, 1014, 955, 1036, 893, 964, 960, 1037, 948, 1053, 992, 992, 895, 
        857, 1019, 1071, 1047, 973, 1036, 1119, 993, 963, 1030, 998, 932, 1019, 1012, 970, 1013, 944, 959, 982, 977, 1004, 
        913, 917, 947, 824, 898, 1014, 1049, 939, 1065, 938, 899, 1172, 973, 971, 985, 944, 1006, 955, 996, 1085, 1005, 891, 
        1105, 989, 1134, 983, 861, 979, 905, 1033, 1014, 1022, 959, 954, 904, 985, 1001, 1000, 950, 939, 1061, 945, 993, 
        1054, 1114, 1071, 927, 897, 957, 1044, 1016, 1031, 989, 971, 950, 1024, 1050, 812, 978, 1012, 927, 1012, 995, 957, 
        997, 948, 1073, 986, 1031, 984, 914, 988, 1057, 1051, 979, 985, 934, 870, 953, 930, 875, 1005, 891, 1102, 912, 977, 
        926, 1038, 1006, 918, 943, 924, 976, 976, 995, 967, 1005, 925, 888, 1062, 1035, 1009, 1008, 1003, 988, 1043, 1019, 
        952, 1083, 985, 957, 1147, 1207, 1032, 860, 1001, 994, 1063, 1029, 906, 1020, 1109, 1088, 961, 872, 942, 1010, 1080, 
        958, 987, 962, 944, 935, 912, 854, 882, 1010, 1027, 916, 829, 933, 1041, 905, 861, 1021, 919, 798, 928, 1086, 923, 
        830, 822, 905, 926, 1015, 931, 1041, 1093, 944, 873, 1073, 1068, 897, 1047, 1011, 1019, 1006, 996, 978, 840, 912, 
        954, 1018, 927, 1040, 995, 883, 941, 990, 934, 908, 986, 969, 1019, 992, 1023, 895, 845, 870, 1074, 930, 976, 912, 
        874, 892, 885, 1044, 1072, 901, 1013, 1043, 926, 1152, 936, 994, 1063, 821, 819, 1001, 975, 982, 905, 1040, 926, 
        1030, 1132, 990, 990, 911, 915, 983)
    dmale <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1)
    dfemale <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 
        1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1)
    emplik:::emplikHs.disc2(x1 = xfemale, d1 = dfemale, y1 = yfemale, x2 = xmale, d2 = dmale, y2 = ymale, theta = c(0.25, 
        0), fun1 = fun2, fun2 = fun2)
}




